<!DOCTYPE html>
<html lang='en'>
<head>
<!--    <script src="js/jquery-ui-1.10.4.custom/js/jquery-ui-1.10.4.custom.min.js
" charset="utf-8"></script>    
-->
    <script src='js/jquery-1.8.2.min.js' type='text/javascript'></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <script src="js/d3.v3.min.js" charset="utf-8"></script>
    <script src='js/lodash.js' type='text/javascript'></script>
    <script src='bootstrap3/js/bootstrap.min.js' type='text/javascript'></script>
    <script src='js/colorbrewer.v1.min.js' type='text/javascript'></script>
    <script src="js/missing-data.js" charset="utf-8"></script>
    <script src="js/crossfilter.js" charset="utf-8"></script>
    <script src="js/box.js" charset="utf-8"></script>
    <script src="js/scatter_lm.js" charset="utf-8"></script>    
    <script src="js/hist_cf.js" charset="utf-8"></script>    
    <link rel="stylesheet" type="text/css" href="bootstrap3/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
<!--     <link rel="stylesheet" type="text/css" href="js/jquery-ui-1.10.4.custom/css/ui-lightness/jquery-ui-1.10.4.custom.min.css
">
 -->
<script>
$.getScript('http://davidstutz.github.io/bootstrap-multiselect/js/bootstrap-multiselect.js',function(){
  
  $('.single option').click(function() {
    // only affects options contained within the same optgroup
    // and doesn't include this
    //$(this).siblings().prop('selected', false);
  });
  
});
</script>
</head>
<body>
<div class='container'>
  <div class='row'>
    <div class="col-md-12 chart" id="chart">
    </div>
  </div>
</div>
<script>

d3.csv('data/beauty.csv', function(error, dat) {

// column_types for beauty.csv
  var dtypes = {
  "tenured": "factor",
  "profnumber": "factor",
  "minority": "factor",
  "age": "integer",
  "beautyf2upper": "integer",
  "beautyflowerdiv": "integer",
  "beautyfupperdiv": "integer",
  "beautym2upper": "integer",
  "beautymlowerdiv": "integer",
  "beautymupperdiv": "integer",
  "btystdave": "numeric",
  "btystdf2u": "numeric",
  "btystdfl": "numeric",
  "btystdfu": "numeric",
  "btystdm2u": "numeric",
  "btystdml": "numeric",
  "btystdmu": "numeric",
  "class1": "factor",
  "class2": "factor",
  "class3": "factor",
  "class4": "factor",
  "class5": "factor",
  "class6": "factor",
  "class7": "factor",
  "class8": "factor",
  "class9": "factor",
  "class10": "factor",
  "class11": "factor",
  "class12": "factor",
  "class13": "factor",
  "class14": "factor",
  "class15": "factor",
  "class16": "factor",
  "class17": "factor",
  "class18": "factor",
  "class19": "factor",
  "class20": "factor",
  "class21": "factor",
  "class22": "factor",
  "class23": "factor",
  "class24": "factor",
  "class25": "factor",
  "class26": "factor",
  "class27": "factor",
  "class28": "factor",
  "class29": "factor",
  "class30": "factor",
  "courseevaluation": "numeric",
  "didevaluation": "integer",
  "female": "factor",
  "formal": "factor",
  "fulldept": "factor",
  "lower": "factor",
  "multipleclass": "factor",
  "nonenglish": "factor",
  "onecredit": "factor",
  "percentevaluating": "numeric",
  "profevaluation": "numeric",
  "students": "integer",
  "tenuretrack": "factor",
  "blkandwhite": "factor",
  "btystdvariance": "numeric",
  "btystdavepos": "numeric",
  "btystdaveneg": "numeric" 
  }
// end dtypes


  dtypes =  _.zipObject(_.keys(dtypes), _.map(_.keys(dtypes), 
    function(d) { 
      return _.contains(['integer', 'numeric'], 
                        dtypes[d]) ? 'numeric': 'factor'}))

  dat.forEach(function(d, i) {
    d._index = i;
    _.map(_.keys(d), function(k) {
      if('numeric' == dtypes[k]){
        d[k] = +d[k]; 
      }
    })
  })
      cf = crossfilter(dat)

      dimension = cf.dimension(function(d) { return d._index})
  var ch = d3.hist_cf()
            .color(colorbrewer.Dark2[5][1])
            .height(250)
            .width(300)
            .tickdiv(5)
            .bins(30),

    numbers = _.filter(_.keys(dtypes), function(d) { return dtypes[d] == 'numeric'})

    all_hist = _.map(_.range(0, numbers.length), function(d) {
      return {vname: numbers[d], dim: dimension};})

    d3.select('#chart').style('float', 'left').selectAll('div')
        .data(all_hist)
        .enter().append('div')
        .style('position', 'relative')
        .each(function() {
          d3.select(this)
            .style('float','left')
            .call(ch);
        });
        
});



</script>
</body>
</html>
